(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[8179],{9873:e=>{e.exports={container:"container-FRMBXkkj",active:"active-FRMBXkkj",title:"title-FRMBXkkj",inactive:"inactive-FRMBXkkj",titleText:"titleText-FRMBXkkj",indicator:"indicator-FRMBXkkj",disconnected:"disconnected-FRMBXkkj",failed:"failed-FRMBXkkj",connecting:"connecting-FRMBXkkj",connected:"connected-FRMBXkkj",loginTooltip:"loginTooltip-FRMBXkkj"}},54157:e=>{e.exports={wrapper:"wrapper-IwJ1xL3u",text:"text-IwJ1xL3u"}},47465:(e,t,n)=>{"use strict";n.d(t,{makeCancelable:()=>r,isCancelled:()=>o});class i{}function r(e){let t=!1;return{promise:new Promise((n,r)=>{e.then(e=>t?r(new i):n(e)),e.catch(e=>r(t?new i:e))}),cancel(){t=!0}}}function o(e){return e instanceof i}},72249:(e,t,n)=>{"use strict";n.d(t,{splitThousands:()=>r});var i=n(93751);function r(e,t="&nbsp;"){let n=e+"";-1!==n.indexOf("e")&&(n=function(e){return(0,i.fixComputationError)(e).toFixed(10).replace(/\.?0+$/,"")}(Number(e)));const r=n.split(".");return r[0].replace(/\B(?=(\d{3})+(?!\d))/g,t)+(r[1]?"."+r[1]:"")}},66854:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getTerminalConfigSet:()=>C});var i=n(25177);const r={paper_trading:{name:"paper_trading",title:(0,i.t)("Trading Panel"),buttonOpenTooltip:(0,i.t)("Open Trading Panel"),buttonCloseTooltip:(0,i.t)("Close Trading Panel"),ctor:null,_gaEvent:"Trading Panel"},scripteditor:{name:"scripteditor",title:(0,i.t)("Pine Editor"),buttonOpenTooltip:(0,i.t)("Open Pine Editor"),buttonCloseTooltip:(0,i.t)("Close Pine Editor"),ctor:null,_gaEvent:"Pine Editor"},backtesting:{name:"backtesting",title:(0,i.t)("Strategy Tester"),buttonOpenTooltip:(0,i.t)("Open Strategy Tester"),buttonCloseTooltip:(0,i.t)("Close Strategy Tester"),ctor:null,_gaEvent:"Strategy Tester"},screener:{name:"screener",title:(0,i.t)("Screener"),buttonOpenTooltip:(0,i.t)("Open Screener"),buttonCloseTooltip:(0,i.t)("Close Screener"),ctor:null,_gaEvent:"Screener"},text_notes:{name:"text_notes",title:(0,i.t)("Text Notes"),buttonOpenTooltip:(0,i.t)("Open Text Notes Panel"),buttonCloseTooltip:(0,i.t)("Close Text Notes Panel"),ctor:null,_gaEvent:"Text Notes"}};var o=n(88537),s=n(33080),a=(n(24818),n(94489)),c=n.n(a),d=n(71757);class l{constructor(e){this._contentRenderer=Promise.resolve(),this._spinnerContainer=document.createElement("div"),this._offlineScreenContainer=document.createElement("div"),this._renderer=Promise.resolve(),this._filter=new(c())(!0),this._bridge=e,(0,s.waitTradingService)().then(e=>{this._trading=e,this.onStatusChange(e.connectStatus()),this._trading.onConnectionStatusChange.subscribe(this,this.onStatusChange)}),n.e(7102).then(n.bind(n,74063)).then(e=>{e.render(this._spinnerContainer)}),(0,d.renderOfflineScreen)((0,o.ensureDefined)(this._offlineScreenContainer))}activate(){this._contentRenderer.then(()=>{this._content&&this._content.drawAttention&&this._content.drawAttention()})}onStatusChange(e,t){this._connectStatus!==e&&(this._connectStatus=this._trading.connectStatus(),window.navigator.onLine?(this._contentRenderer=Promise.resolve(),
this._content&&this._content.remove(),2===e&&this._renderSpinner(),3!==e&&4!==e?1===e&&this._renderAccountManager(this._trading.activeBroker()):this._renderSpinner()):this._renderOfflineScreen())}_renderSpinner(){this._bridge.container.innerText="",this._content=this._bridge.container.appendChild(this._spinnerContainer)}_renderOfflineScreen(){this._bridge.container.innerText="",this._content=this._bridge.container.appendChild(this._offlineScreenContainer)}async _createAccountManager(e){const{AccountManager:t}=await Promise.all([n.e(9685),n.e(5514),n.e(9129),n.e(2e3),n.e(6363),n.e(3466),n.e(7836),n.e(3921),n.e(7427),n.e(7552),n.e(7419),n.e(3727),n.e(2335),n.e(3975),n.e(3944),n.e(419),n.e(9255),n.e(2930),n.e(7664),n.e(9578),n.e(6872),n.e(8354)]).then(n.bind(n,56718)),{SummaryFieldsVisibilityManager:i}=await Promise.all([n.e(9685),n.e(5514),n.e(9129),n.e(2e3),n.e(6363),n.e(3466),n.e(7836),n.e(3921),n.e(7427),n.e(7552),n.e(7419),n.e(3727),n.e(2335),n.e(3975),n.e(3944),n.e(419),n.e(9255),n.e(2930),n.e(7664),n.e(9578),n.e(6872),n.e(8354)]).then(n.bind(n,56656));if(this._contentRenderer!==this._renderer)return;this._content&&this._content.remove();const r=new i((0,o.ensureNotNull)(e).accountManagerInfo().summary,this._trading.getBrokerTradingSettingsStorage);this._content=await t.create({broker:e,bridge:this._bridge,mode:1,summaryFieldsVisibilityManager:r})}_renderAccountManager(e){this._renderer=this._contentRenderer=this._createAccountManager(e)}_renderBrokerSelectScreen(){0}}var u=n(59496),h=n(97754),p=n(82527),g=n(47465),m=n(50681),f=n(9873);const _=(0,i.t)("Trading Panel"),T=(0,i.t)("Account Manager"),b={4:"failed",2:"connecting",1:"connected",3:"disconnected"},S={4:(0,i.t)("Failed"),2:(0,i.t)("Connecting"),1:(0,i.t)("Connected"),3:(0,i.t)("Disconnected")};class v extends u.PureComponent{constructor(e){super(e),this._trading=null,this._tradingServiceCancelable=null,this._titleClick=()=>{const{onClick:e}=this.props;e&&e()},this.state={status:3,hasActiveBroker:!1,title:p.enabled("trading_terminal")?T:_}}componentDidMount(){if(p.enabled("trading_terminal"))return;const e=(0,s.tradingService)();null===e?(this._tradingServiceCancelable=(0,g.makeCancelable)((0,s.waitTradingService)()),this._tradingServiceCancelable.promise.then(this._onTradingService.bind(this))):this._onTradingService(e)}componentWillUnmount(){p.enabled("trading_terminal")||(this._cancelWaitingTrading(),null!==this._trading&&(this._trading.onBrokerChange.unsubscribe(this,this._update),this._trading.onConnectionStatusChange.unsubscribe(this,this._update)))}render(){const{status:e,hasActiveBroker:t,title:n}=this.state;return u.createElement("div",{className:h(m.bottomTradingTabClassName,f.container,f[b[e]],{[f.active]:this.props.isActive,[f.inactive]:!t}),onClick:this._titleClick,"data-name":this.props.dataName,"data-active":this.props.isActive},u.createElement("span",{className:f.title},u.createElement("span",{className:f.titleText},n)),u.createElement("div",{className:h(f.indicator,"apply-common-tooltip"),title:S[e]}))}_onTradingService(e){
this._cancelWaitingTrading(),this._trading=e,e.onBrokerChange.subscribe(this,this._update),e.onConnectionStatusChange.subscribe(this,this._update),this._update()}_update(){const e=this._trading,t=e&&e.activeBroker(),n=e?e.connectStatus():3;window.is_authenticated&&!p.enabled("trading_terminal")&&e&&t&&1===n?this.setState({status:n,hasActiveBroker:!0,title:t.accountManagerInfo().accountTitle}):this.setState({status:n,hasActiveBroker:!1,title:_})}_cancelWaitingTrading(){null!==this._tradingServiceCancelable&&(this._tradingServiceCancelable.cancel(),this._tradingServiceCancelable=null)}}var k=n(2683);function C(){const e={paper_trading:{ctor:l,customTitleComponent:v}};return(0,k.merge)((0,k.clone)(r),e)}},71757:(e,t,n)=>{"use strict";n.d(t,{OfflineScreen:()=>a,renderOfflineScreen:()=>c});var i=n(59496),r=n(87995),o=n(25177),s=n(54157);function a(){return i.createElement("div",{className:s.wrapper},i.createElement("p",{className:s.text},(0,o.t)("Lost internet connection")))}function c(e){r.render(i.createElement(a,null),e)}},44963:(e,t,n)=>{"use strict";var i;n.d(t,{StopType:()=>i}),function(e){e[e.StopLoss=0]="StopLoss",e[e.TrailingStop=1]="TrailingStop"}(i||(i={}))},44777:(e,t,n)=>{"use strict";n.d(t,{DisconnectError:()=>s,extractDisconnectionInfoAndConnectionStatus:()=>a});var i=n(24818),r=n(50317),o=n(50420);class s extends o.UserFriendlyError{constructor({disconnectInfo:e,...t}){super(t),this.name="DisconnectError",this.disconnectInfo=e}}function a(e){const t=function(e){const t={message:(0,r.getErrorMessage)(e)};e instanceof s&&(t.disconnectType=e.disconnectInfo.disconnectType);return t}(e);let n=4;return void 0!==t.disconnectType&&[i.DisconnectType.CancelAuthorization,i.DisconnectType.TimeOutForAuthorization].includes(t.disconnectType)&&(n=3),{disconnectionInfo:t,connectionStatus:n}}},50420:(e,t,n)=>{"use strict";n.d(t,{UserFriendlyError:()=>i});class i extends Error{constructor({detailedErrorMessage:e,userFriendlyMessage:t}){super(t),this.name="UserFriendlyError",this.detailedErrorMessage=e}}},50317:(e,t,n)=>{"use strict";n.d(t,{orderStatusToText:()=>T,sideToText:()=>S,orderTypeToText:()=>v,findArraysDifferences:()=>k,formatNumber:()=>C,isOrderOrPositionMessageType:()=>x,roundToStepByPriceTypeAndSide:()=>y,TasksWithTermination:()=>w,numOfDecimalPlaces:()=>O,roundDownToPowerOf10:()=>B,isFinalOrderStatus:()=>F,positionSideToText:()=>P,makeNonTradableSymbolText:()=>A,getErrorMessage:()=>N,getLoggerMessage:()=>L});var i=n(25177),r=n(60521),o=n(24818),s=n(72249),a=n(2683),c=n(51951),d=n(96796),l=n(50420),u=n(44777);const h={2:{},1:{}},p={},g={},m={};let f=!1;const _=(0,c.getLogger)("Trading.Utils");function T(e){return b(),m[e]}function b(){f||(f=!0,h[2][2]=(0,i.t)("Mkt",{context:"Market order"}),h[2][1]=(0,i.t)("Lmt",{context:"Limit order"}),h[2][3]=(0,i.t)("Stp",{context:"order"}),h[2][4]=(0,i.t)("Stp lmt",{context:"Stop limit order"}),h[1][2]=(0,i.t)("Market"),h[1][1]=(0,i.t)("Limit"),h[1][3]=(0,i.t)("Stop",{context:"order"}),h[1][4]=(0,i.t)("StopLimit"),p[1]=(0,i.t)("Buy",{context:"trading"}),p[-1]=(0,
i.t)("Sell",{context:"trading"}),g[1]=(0,i.t)("Long",{context:"trading"}),g[-1]=(0,i.t)("Short",{context:"trading"}),m[2]=(0,i.t)("filled"),m[1]=(0,i.t)("cancelled"),m[6]=(0,i.t)("working"),m[3]=(0,i.t)("inactive"),m[4]=(0,i.t)("placing"),m[5]=(0,i.t)("rejected"))}function S(e,t){b();const n=p[e];return t?n.toUpperCase():n}function v(e,t,n){b();const i=n?2:1;return t?h[i][e].toUpperCase():h[i][e]}function k(e,t,n,i,r){const o={added:[],modified:[],removed:[]},s=e.slice(0);return t.forEach(t=>{const c=e.findIndex(e=>e[n]===t[n]);if(-1===c)return void o.added.push(t);s[c]=null;const d=e[c];for(const e of i){let n=!0;if(null===d[e]||"object"!=typeof d[e]?n=d[e]===t[e]:r&&(n=(0,a.deepEquals)(d[e],t[e])[0]),!n)return void o.modified.push(t)}}),s.forEach(e=>{e&&o.removed.push(e)}),o}function C(e){return Math.abs(e||0)<.001?"0.00":(0,s.splitThousands)((e||0).toFixed(2))}function x(e){return-1!==Object.keys(o.OrderOrPositionMessageType).map(e=>o.OrderOrPositionMessageType[e]).indexOf(e)}function y(e,t,n,i){const o=(0,r.Big)(e).div(t);return 1===n&&1===i||2===n&&-1===i?o.round(0,0).mul(t).toNumber():1===n&&-1===i||2===n&&1===i?o.round(0,3).mul(t).toNumber():0}const M=(0,i.t)("Failed to login");class w{constructor(e){this._isFinished=!1,this._isTerminated=!1,this._tasks=e}execute(){return this._isTerminated=!1,this._isExecuted()&&!this._isFinished?this.terminate().then(()=>this._execution=this._execute()):this._execution=this._execute()}async terminate(){if(this._isExecuted()&&!this._isFinished){this._isTerminated=!0;try{await this._execution}catch(e){return void _.logWarn(e)}}}_isExecuted(){return!!this._execution}async _execute(){for(const e of this._tasks){if(this._isTerminated)throw new Error("Login tasks are terminated");try{await e()}catch(e){this._isFinished=!0;const t={detailedErrorMessage:`${M}${E(L(e))}`,userFriendlyMessage:`${M}${E(N(e))}`};throw e instanceof u.DisconnectError?new u.DisconnectError({...t,disconnectInfo:e.disconnectInfo}):new l.UserFriendlyError(t)}}this._isFinished=!0}}function E(e){return void 0===e||""===e?"":": "+e}function O(e){return(new r.Big(e).toFixed().split(".")[1]||"").length}function B(e){return(0,r.Big)(10).pow(Math.floor(Math.log10(e))).toNumber()}function F(e){return-1!==[2,1,5].indexOf(e)}function P(e){return b(),g[e]}function A(e,t){return(0,i.t)("You can't trade the symbol {symbol} at TradingView via {broker}.").replace("{symbol}",e).replace("{broker}",t)}function N(e){if(void 0===e)return(0,i.t)("Unknown error");let t;return t=e instanceof Error?e.message:"object"==typeof e?JSON.stringify(e):e.toString(),(0,d.removeTags)(t)}function L(e){return e instanceof l.UserFriendlyError?(0,d.removeTags)(e.detailedErrorMessage):N(e)}},50681:(e,t,n)=>{"use strict";n.d(t,{bottomTradingTabClassName:()=>d,orderStatusToText:()=>c.orderStatusToText,brokersListFromPlans:()=>u,isOAuthAuthType:()=>p,executionText:()=>g,convertActionDescriptionsToActions:()=>m,isOrderActive:()=>f,makeBrokerSideMaintananceFeatureToggleName:()=>_,makeMaintananceFeatureToggleName:()=>T,getCurrency:()=>b,
isModifyOrderSupported:()=>v,isMoveOrderSupported:()=>k,isBatsQuotes:()=>C,isDefined:()=>x,alignToStep:()=>y,makeDatePlus24UTCHours:()=>M,findDurationMetaInfo:()=>w});var i=n(60521),r=n.n(i),o=n(88537),s=n(44963),a=n(90687),c=n(50317);const d="js-bottom-trading-tab";const l=["Paper"];function u(e,t){const n=e.map(e=>e.id),i=t.map(e=>e.slug_name),r=t.filter(e=>n.includes(e.slug_name)).map(t=>({metainfo:h(e,t.slug_name),brokerPlan:t})),o=e.filter(e=>!i.includes(e.id)&&!l.includes(e.id)).map(e=>({metainfo:e})),s=l.map(t=>({metainfo:h(e,t)}));return s.length>0&&r.splice(0,0,...s),[...r,...o]}function h(e,t){return(0,o.ensureDefined)(e.find(e=>e.id.toLowerCase()===t.toLowerCase()))}function p(e){return void 0!==e&&["oauth","oauth2-implicit-flow","oauth2-code-flow"].includes(e)}function g(e,t){const n=(0,c.sideToText)(e.side)+" "+e.qty+" @ "+t.format(e.price);return n.substring(0,1).toUpperCase()+n.substring(1).toLowerCase()}function m(e){return e?e.map(e=>"-"===e.text||e.separator?new a.Separator:new a.Action({actionId:"Trading.CustomActionId",name:e.name,checkable:e.checkable,checked:e.checked,disabled:void 0!==e.enabled&&!e.enabled,label:e.text,statName:e.statName,icon:e.icon,onExecute:t=>{const n=t.getState();e.action({checkable:n.checkable,checked:n.checked,enabled:!n.disabled,text:n.label})}})):[]}function f(e){return 6===e||3===e}function _(e){return(e+"-brokers-side-maintenance").toLowerCase()}function T(e){return(e+"-maintenance").toLowerCase()}function b(e,t){return!t&&e.currencySign||e.currency||""}function S(e,t){return Boolean(void 0!==e.parentId&&t.supportModifyBrackets&&(t.supportTrailingStop&&t.supportModifyTrailingStop||e.stopType!==s.StopType.TrailingStop))}function v(e,t){const n=void 0===e.parentId&&(t.supportModifyOrderPrice||t.supportEditAmount||t.supportModifyBrackets),i=S(e,t);return Boolean(n||i)}function k(e,t){const n=void 0===e.parentId&&t.supportModifyOrderPrice,i=S(e,t);return Boolean(n||i)}function C(e){var t;return"BATS"===(null===(t=e.originalName)||void 0===t?void 0:t.split(":")[0])}function x(e){return null!=e}function y(e,t){return r()(e).div(t).round(0,1).mul(t).toNumber()}function M(){const e=new Date;return e.setUTCHours(e.getUTCHours()+24),e}function w(e,t){return e.find(e=>e.value===t)}}}]);